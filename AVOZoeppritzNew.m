function [Rpp,Rps,tD1,Intercept,Gradient]=AVOZoeppritzNew(Vp1,Vp2,Vs1,Vs2,RHOB1,RHOB2)%	The Zoeppritz-Aki-Richards AVO equations as in The Rock Physics Manual, page 61%	where Rtt is reflectivity at angle t; Rps is from P to S; and R0 is normal reflectivity.%	"1"		Property above the reflecting interface%	"2"		property below the reflecting interface%	Written by Jack Dvorkin 06/04Ip1=Vp1.*RHOB1; Ip2=Vp2.*RHOB2;PR1=.5*((Vp1./Vs1).^2-2)./((Vp1./Vs1).^2-1);PR2=.5*((Vp2./Vs2).^2-2)./((Vp2./Vs2).^2-1);%	Angle in degreestD1=[0:1:60]';%	Angle in radiant1=tD1/57.32;%	Normal reflectivityR0=(Ip2-Ip1)./(Ip2+Ip1);%	Reflection and transmission anglest2=asin(Vp2.*sin(t1)./Vp1);p1=asin(Vs1.*sin(t1)./Vp1);p2=asin(Vs2.*sin(t1)./Vp1);%	Various parametersa=RHOB2.*(1-2.*sin(p2).*sin(p2))-RHOB1.*(1-2.*sin(p1).*sin(p1));b=RHOB2.*(1-2.*sin(p2).*sin(p2))+2.*RHOB1.*sin(p1).*sin(p1);c=RHOB1.*(1-2.*sin(p1).*sin(p1))+2.*RHOB2.*sin(p2).*sin(p2);d=2.*(RHOB2.*Vs2.*Vs2-RHOB1.*Vs1.*Vs1);p=sin(t1)./Vp1;E=b.*cos(t1)./Vp1+c.*cos(t2)./Vp2;F=b.*cos(p1)./Vs1+c.*cos(p2)./Vs2;G=a-d.*cos(t1).*cos(p2)./(Vp1.*Vs2);H=a-d.*cos(t2).*cos(p1)./(Vp2.*Vs1);D=E.*F+G.*H.*p.*p;%	Reflectivity versus angleRpp=(F.*(b.*cos(t1)./Vp1-c.*cos(t2)./Vp2)-H.*p.*p.*(a+d.*cos(t1).*cos(p2)./(Vp1.*Vs2)))./D;Rps=(-2.*(cos(t1)./Vp1).*(a.*b+c.*d.*cos(t2).*cos(p2)./(Vp2.*Vs2)).*p.*Vp1)./(Vs1.*D);Rpp=real(Rpp+.00001); Rps=real(Rps+.00001);%	InterceptIntercept=R0;%	GradientGradientVect=(Rpp(2:59)-R0)./((sin(t1(2:59))).^2);Gradient=mean(GradientVect(1:end));