function [RHOw,Kw,Vpw,RHOo,Ko,Vpo,RHOg,Kg,Vpg]=BatzleWangNew(Salinity,OilAPI,GasGravity,GOR,GWR,P,T)%Batzle-Wang empirical equations%			OUTPUTS%RHOw		Brine density (g/cc)%Kw			Brine bulk modulus (GPa)%Vpw		Brine Vp (km/s)%RHOo		Oil density (g/cc)%Ko			Oil bulk modulus (GPa)%Vpo		Oil Vp (km/s)%RHOg		Gas density (g/cc)%Kg			Gas bulk modulus (GPa)%Vpg		Gas Vp (km/s)%			INPUTS%Salinity	NaCl Salinity of Brine (ppm)%OilAPI		Oil API%GasGravity	Gas Gravity%GOR		Gas-to-Oil ratio%GWR		Gas-to-Brine ratio%P			Pore pressure (MPa)%T			Temperature (C)%Written by Li Teng (1997)%Modified by Jack Dvorkin (2002)%Based on Batzle, M., and Wang, Z., 1992, Seismic properties of pore fluids, Geophysics, 57, 1396-1408.%Salinity is in ppm divided by 1e6sal=Salinity./1e6;%Ideal gas constantR=8.31441;%Gas densitygg=GasGravity;Pr=P./(4.892-0.4048.*gg);Tr=(T+273.15)./(94.72+170.75.*gg);E=0.109.*(3.85-Tr).^2.*exp(-(0.45+(8.*(0.56-1./Tr).^2)).*(Pr.^1.2./Tr));Z=(0.03+0.00527.*(3.5-Tr).^3).*Pr+(0.642.*Tr-0.007.*Tr.^4-0.52)+E;RHOg=28.8.*gg.*P./(Z.*R.*(T+273.15)); %Gas adiabatic bulk modulusgamma=0.85+5.6./(Pr+2)+27.1./(Pr+3.5).^2-8.7.*exp(-0.65.*(Pr+1));f=E.*1.2.*(-(0.45+8.*(0.56-1./Tr).^2).*Pr.^0.2./Tr)+(0.03+0.00527.*(3.5-Tr).^3);Kg=P.*gamma./(1-Pr./Z.*f)./1000;Vpg=sqrt(Kg./RHOg);%Oil densityog=OilAPI;rho0=141.5./(og+131.5);%Dead oil vs. live oilgor=GOR;if (gor==0)  rhoog=rho0;  rhop=rhoog+(0.00277.*P-1.71e-7.*P.^3).*(rhoog-1.15).^2+3.49e-4.*P;  RHOo=rhop./(0.972+3.81e-4.*(T+17.78).^1.175);else  B0=0.972+0.00038.*(2.4.*gor.*sqrt(gg./rho0)+T+17.8).^1.175;  rhoog=(rho0+0.0012.*gg.*gor)./B0;  RHOo=rhoog+(0.00277.*P-1.71e-7.*P.^3).*(rhoog-1.15).^2+3.49e-4.*P;end%Oil velocity%Live oil use pseudo densityif (gor~=0)  rho0=rho0./B0./(1+0.001.*gor);endVpo=2096.*sqrt(rho0./(2.6-rho0))-3.7.*T+4.64.*P+0.0115.* ...(4.12.*sqrt(1.08./rho0-1)-1).*T.*P;Vpo=Vpo./1000;Ko=Vpo.*Vpo.*RHOo;%Brine densityrhow=1+1e-6.*(-80.*T-3.3.*T.^2+0.00175.*T.^3+489.*P-2.*T.*P+ ...0.016.*T.^2.*P-1.3e-5.*T.^3.*P-0.333.*P.^2-0.002.*T.*P.^2);rhob=rhow+sal.*(0.668+0.44.*sal+1e-6.*(300.*P-2400.*P.*sal+ ...T.*(80+3.*T-3300.*sal-13.*P+47.*P.*sal)));RHOw=rhob;%Brine velocitymatrixw=[1402.85 4.871 -0.04783 1.487e-4 -2.197e-71.524 -0.0111 2.747e-4 -6.503e-7 7.987e-103.437e-3 1.739e-4 -2.135e-6 -1.455e-8 5.230e-11-1.197e-5 -1.628e-6 1.237e-8 1.327e-10 -4.614e-13]';%Water velocityvelw=0;for i=1:5for j=1:4  velw=velw+matrixw(i,j).*T.^(i-1).*P.^(j-1);endend% mmm=matrixw;% velw=mmm(1,1)*(T^0)*(P^0)+mmm(1,2)*(T^0)*(P^1) +mmm(1,3)*(T^0)*(P^2) +mmm(1,4)*(T^0)*(P^3)+ ...% mmm(2,1)*(T^1)*(P^0)+mmm(2,2)*(T^1)*(P^1) +mmm(2,3)*(T^1)*(P^2) +mmm(2,4)*(T^1)*(P^3)+ ...% mmm(3,1)*(T^2)*(P^0)+mmm(3,2)*(T^2)*(P^1) +mmm(3,3)*(T^2)*(P^2) +mmm(3,4)*(T^2)*(P^3)+ ...% mmm(4,1)*(T^3)*(P^0)+mmm(4,2)*(T^3)*(P^1) +mmm(4,3)*(T^3)*(P^2) +mmm(4,4)*(T^3)*(P^3)+ ...% mmm(5,1)*(T^4)*(P^0)+mmm(5,2)*(T^4)*(P^1) +mmm(5,3)*(T^4)*(P^2) +mmm(5,4)*(T^4)*(P^3);%Gas water ratiogwrmax=10.^(log10(0.712.*P.*(abs(T-76.71)).^1.5+3676.*P.^0.64)-4- ...7.786.*sal.*(T+17.78).^(-0.306));gwr=gwrmax.*GWR;%Gas-free brine and brine with gasvpb0=velw+sal.*(1170-9.6.*T+0.055.*T.^2-8.5e-5.*T.^3+2.6.*P- ...0.0029.*T.*P-0.0476.*P.^2)+sal.^1.5.*(780-10.*P+0.16.*P.^2)-1820.*sal.^2;vpb=vpb0./(sqrt(1+0.0494.*gwr));Vpw=vpb./1000;Kw=Vpw.*Vpw.*RHOw;