function [VpSatB,VsSatB,RHOBSatB]=FluidA2FluidBGassmann(VpSatA,VsSatA,RHOBSatA,Ks,Phi,KfA,RHOfA,KfB,RHOfB)% Gassmann's fluid substitution from fluid A to fluid B% VpSatA,VsSatA,RHOBSatA are the velocities and bulk density of rock with% fluid A (input)% VpSatB,VsSatB,RHOBSatB are the velocities and bulk density of rock with% fluid B (output)% KfA, RHOfA, KfB, RHOfB are the bulk moduli and densities of fluids A and% B (input)% Phi is porosity% Ks is the bulk modulus of teh solid phase (rock matrix)%Written by Jack Dvorkin 08/2024% Elastic moduli of rock with FluidAMA=VpSatA.*VpSatA.*RHOBSatA; G=VsSatA.*VsSatA.*RHOBSatA; KA=MA-(4/3)*G;% Dry-rock bulk modulus and bulk densityKDry=Ks.*(1-(1-Phi).*KA./Ks-Phi.*KA./KfA)./(1+Phi-Phi.*Ks./KfA-KA./Ks);RHOBDry=RHOBSatA-Phi.*RHOfA;% Bulk modulus and density of rock with fluid BKSatB=Ks.*(Phi.*KDry-(1+Phi).*KfB.*KDry./Ks+KfB)./((1-Phi).*KfB+Phi.*Ks-KfB.*KDry./Ks);MSatB=KSatB+(4/3)*G;RHOBSatB=RHOBDry+Phi.*RHOfB;VpSatB=sqrt(MSatB./RHOBSatB);VsSatB=sqrt(G./RHOBSatB);%[KDry KSatB]